CREATE TABLE Book (
	bid VARCHAR(20) NOT NULL,
	title VARCHAR(60) NOT NULL,
	price INT NOT NULL,
	category VARCHAR(20) NOT NULL,
	PRIMARY KEY(bid)
);

CREATE TABLE Address (
	id integer not null GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
	street VARCHAR(100) NOT NULL,
	province VARCHAR(20) NOT NULL,
	country VARCHAR(20) NOT NULL,
	zip VARCHAR(20) NOT NULL,
	phone VARCHAR(20),
	PRIMARY KEY(id)
);

CREATE TABLE PO (
	id  integer not null GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1),
	lname VARCHAR(20) NOT NULL,
	fname VARCHAR(20) NOT NULL,
	status VARCHAR(20) NOT NULL,
	address INT  NOT NULL,
	PRIMARY KEY(id),
	FOREIGN KEY (address) REFERENCES Address (id) ON DELETE CASCADE
);

CREATE TABLE POItem (
	id INT NOT NULL,
	bid VARCHAR(20) NOT NULL,
	price INT NOT NULL,
	quantity INT NOT NULL,
	PRIMARY KEY(id,bid),
	FOREIGN KEY(id) REFERENCES PO(id) ON DELETE CASCADE,
	FOREIGN KEY(bid) REFERENCES Book(bid) ON DELETE CASCADE
);

CREATE TABLE VisitEvent (
	day varchar(8) NOT NULL,
	bid varchar(20) not null REFERENCES Book(bid),
	eventtype VARCHAR(20) NOT NULL,
	FOREIGN KEY(bid) REFERENCES Book(bid)
);

CREATE TABLE BOOKEXTRA (
	description varchar(100),
	bid varchar(20) NOT NULL REFERENCES Book(bid),
	FOREIGN KEY(bid) REFERENCES Book(bid)
);

CREATE TABLE USERS(
	USERNAME VARCHAR(60) NOT NULL,
	HASHEDPASSWORD VARCHAR(512) NOT NULL,
	PRIMARY KEY(USERNAME)
);

CREATE TABLE USERINFO (
	USERNAME VARCHAR(60) NOT NULL,
	FNAME VARCHAR(30) NOT NULL,
	LNAME VARCHAR(30) NOT NULL,
	ADDRESS VARCHAR(30) NOT NULL,
	ADDRESS2 VARCHAR(30) ,
	CITY VARCHAR(30) NOT NULL,
	PROVINCE VARCHAR(30) NOT NULL,
	POSTALCODE VARCHAR(30) NOT NULL,
	COUNTRY VARCHAR(30) NOT NULL,
	PHONENUMBER VARCHAR(30) ,
	PRIMARY KEY(USERNAME),
	FOREIGN KEY(USERNAME) REFERENCES USERS(USERNAME)
);

